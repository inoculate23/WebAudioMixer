<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Web Audio Mixer</title>
	
	<!--Load external font (google font)-->
	<link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap" rel="stylesheet">
	
	<!--Load external style sheet-->
	<link href="styles/default-styles.css" type="text/css" rel="stylesheet" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">
	<!--Load external java modules-->
	   <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
    <script type="module" src="./src/wavesurfer.js"></script>
	<script src="./src/loader.js" type="module">
	
		// Chrome autoplay fix
		// https://developers.google.com/web/updates/2017/09/autoplay-policy-changes
		document.querySelector("audio").onplay = (e) => {
  		if (audioCtx.state == "suspended") {
    	audioCtx.resume();
  }
};</script>
</head>
<body>
<main>
	
	<div id="container">
		<h1>Web Audio Mixer</h1>
		
		<!--Audio visualization-->
		<canvas width="800" height="400"></canvas>

		<section id="filters">
		  <span><input type="checkbox" id="gradientCB" checked><label for="gradientCB">Show Gradient</label></span>
		  <span><input type="checkbox" id="barsCB" checked><label for="barsCB">Show Bars</label></span>
		  <span><input type="checkbox" id="circlesCB" checked><label for="circlesCB">Show Circles</label></span>
		  <span><input type="checkbox" id="noiseCB"><label for="noiseCB">Show Noise</label></span>
		  <span><input type="checkbox" id="invertCB"><label for="invertCB">Invert Colors</label></span>
		  <span><input type="checkbox" id="embossCB"><label for="embossCB">Show Emboss</label></span>
		</section><br>

		<div id="controls">
		
<!--	**********  CHANNEL ONE  **********		-->	
		
			<div id="channelOne">
					
				<label title="Click to browse and select an audio file to load into Web Audio Mixer." for="uploadOne" class="customFileUploader">Load Track</label>
					<input type="file" id="uploadOne" accept="audio/*"><br><br><br>
				
				<label id="analogLabel">Channel 1</label><br><br>
				
				<section id="gain">
					<label title="Adjusts the audio input volume prior to equalization." id="analogLabel">Gain :</label>
					<input title="Adjusts the audio input volume prior to equalization." type="range" id="gainSliderOne" min="0" max="2" value="1" step="0.01">
				</section><br>
				
				<section id="eq">
					<label title="Adjusts the amplification of high frequency audio. ( >1280 hz )" id="analogLabel">High :</label>
					<input title="Adjusts the amplification of high frequency audio. ( >1280 hz )"type="range" id="highSliderOne" min="-20" max="20" value="0" step="1"><br>
					
					<label title="Adjusts the amplification of mid range frequency audio. ( peak at 720 hz )" id="analogLabel">Mid- :</label>
					<input title="Adjusts the amplification of mid range frequency audio. ( peak at 720 hz )" type="range" id="midSliderOne" min="-20" max="20" value="0" step="1"><br>
					
					<label title="Adjusts the amplification of low frequency audio. ( <160 hz )" id="analogLabel">Low- :</label>
					<input title="Adjusts the amplification of low frequency audio. ( <160 hz )" type="range" id="lowSliderOne" min="-20" max="20" value="0" step="1"><br>
				</section><br>
				
				<section id="volume">
					<label title="Adjusts audio volume after equalization." id="analogLabel">Volume<br></label>
					<input title="Adjusts audio volume after equalization." type="range" id="volumeSliderOne" min="0" max="1" value="0.9" step="0.01">
				</section>

				<section id="buttons">
					<button id="playButtonOne" class="customFileUploader" data-playing="no"></button>
				</section>

			</div><!-- channelOne -->


<!--	**********  MIXER  Panel  **********		-->
						
			<div id="mixer">
				<center> <img src="https://inoculate.media/assets/digimix.png" width="325px" /><br></center>
				<center><img src="https://inoculate.media/assets/haawke_wh.png" width="175px" /></center><br>


				<section id="cross">
					<label title="Select the rate at which the crossfader blends the two audio channels. Linear is smooth, squared is an exponential rate of change often used for scratching." id="analogLabel">Graduated Cross Fader</label><br><br>
  					<label id="analogLabel" title="Select the rate at which the crossfader blends the two audio channels. Linear is smooth, squared is an exponential rate of change often used for scratching.">Linear</label>
  					<input type="radio" name="graduated" id="linear" value=0 checked="checked" title="Select the rate at which the crossfader blends the two audio channels. Linear is smooth, squared is an exponential rate of change often used for scratching.">
  					<input type="radio" name="graduated" id="exponential" value=1 title="Select the rate at which the crossfader blends the two audio channels. Linear is smooth, squared is an exponential rate of change often used for scratching.">
  					<label id="analogLabel" title="Select the rate at which the crossfader blends the two audio channels. Linear is smooth, squared is an exponential rate of change often used for scratching.">Square</label><br><br><br>
					<label id="analogLabel" title="Inverts the poles on the crossfader switching which side is associated with which channel. Often used for scratching.">Hamster Switch</label><br><br>
  					<label id="analogLabel" title="Inverts the poles on the crossfader switching which side is associated with which channel. Often used for scratching.">1&lt;-&gt;2</label>
  					<input type="radio" name="hamster" id="regular" value=0 checked="checked" title="Inverts the poles on the crossfader switching which side is associated with which channel. Often used for scratching.">
  					<input type="radio" name="hamster" id="inverted" value=1 title="Inverts the poles on the crossfader switching which side is associated with which channel. Often used for scratching.">
  					<label id="analogLabel" title="Inverts the poles on the crossfader switchhtWebAudioMixer/media/kandinsky-download-1689962188266.png
					<label id="analogLabel" title="Used to blend the two audio channels.">Cross Fader</label><br>
					<input type="range" id="crossFader" min="0" max="1" value="0.5" step="0.001" title="Used to blend the two audio channels.">
				</section>
			</div><!-- mixer -->

						
<!--	**********  CHANNEL TWO  **********		-->
		
			<div id="channelTwo">
			
				<label title="Click to browse and select an audio file to load into Web Audio Mixer." for="uploadTwo" class="customFileUploader">Load Track</label>
					<input type="file" id="uploadTwo" accept="audio/*"><br><br><br>
				
				<label id="analogLabel">Channel 2</label><br><br>
				
				<section id="gain">
					<label title="Adjusts the audio input volume prior to equalization." id="analogLabel">Gain :</label>
					<input title="Adjusts the audio input volume prior to equalization." type="range" id="gainSliderTwo" min="0" max="2" value="1" step="0.01">
				</section><br>

				<section id="eq">
					<label title="Adjusts the amplification of high frequency audio. ( >1280 hz )" id="analogLabel">High :</label>
					<input title="Adjusts the amplification of high frequency audio. ( >1280 hz )" type="range" id="highSliderTwo" min="-20" max="20" value="0" step="1"><br>
					
					<label title="Adjusts the amplification of mid range frequency audio. ( peak at 720 hz )" id="analogLabel">Mid- :</label>
					<input title="Adjusts the amplification of mid range frequency audio. ( peak at 720 hz )" type="range" id="midSliderTwo" min="-20" max="20" value="0" step="1"><br>
					
					<label title="Adjusts the amplification of low frequency audio. ( <160 hz )" id="analogLabel">Low- :</label>
					<input title="Adjusts the amplification of low frequency audio. ( <160 hz )" type="range" id="lowSliderTwo" min="-20" max="20" value="0" step="1"><br>
				</section><br>
				
				<section id="volume">
					<label title="Adjusts audio volume after equalization." id="analogLabel">Volume<br></label>
					<input title="Adjusts audio volume after equalization." type="range" id="volumeSliderTwo" min="0" max="1" value="0.9" step="0.01">
				</section>

				<section id="buttons">
					<button id="playButtonTwo" class="customFileUploader" data-playing="no"></button>
				</section>

			</div><!-- channelTwo -->
		</div><!-- controls -->
		   <div id="waveform"></div>

        <p>
            <label>
            <input type="checkbox" checked="${loop}" />
            Loop regions
          </label>

            <label style="margin-left: 2em">
            Zoom: <input type="range" min="10" max="1000" value="10" />
          </label>
        </p>

    </main>
    <script src="./src/sketch.js"></script>
</body>

</html>
	</div><!-- container -->
	<!-- PAGE STUFF -->
<div id="app" @mouseUp="unselectKnobs">
    <div class="page-container">
        <div class="rela-block container">
            
            <!-- Effects -->
            <div v-for="effect in effects" class="rela-inline effect-container" @mouseDown="effect.selected = true;">
                <div class="rela-block effect-label">
                    <div class="rela-inline effect-active-light" :style="{'background-color': effect.active?effect.color:'#888'}" 
                         @click="effect.active = !effect.active"></div>
                    {{effect.label}}
                </div>
                <div class="rela-block knob-container">
                    <div v-for="knob in effect.knobs" :class="['rela-inline', 'knob', 'style'+effect.knobStyle]">
                        <div class="rela-block knob-dial" :style="{'color':effect.active?effect.color:'#888'}">
                            <div class="abs-center dial-grip" :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}" 
                                 @mouseDown="knob.selected = true; currentY = event.pageY; event.preventDefault()"></div>
                            <svg class="dial-svg" viewBox="0 0 100 100">
                                <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C"/>
                                <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" :stroke="effect.active?effect.color:'#888'" 
                                      :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}"/>
                            </svg>
                        </div>
                        <div class="rela-block knob-label" :style="{'color':effect.active?'#E4E8EA':'#888'}">{{knob.label}}</div>
                    </div>
                </div>
            </div>
            
            <br>
            
            <!-- Knobs -->
            <div v-for="knob in knobs" :class="['rela-inline', 'knob', 'style'+knob.style]">
                <div class="knob-active-light" :style="{'background-color': knob.active?knob.color:'#888'}" @click="knob.active = !knob.active"></div>
                <div class="rela-block knob-dial" :style="{'color':knob.active?knob.color:'#888'}">
                    <div class="abs-center dial-grip" :style="{'transform': 'translate(-50%,-50%) rotate('+knob.rotation+'deg)'}" 
                         @mouseDown="knob.selected = true; app.currentY = event.pageY; event.preventDefault()"></div>
                    <svg class="dial-svg" viewBox="0 0 100 100">
                        <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" stroke="#55595C"/>
                        <path d="M20,76 A 40 40 0 1 1 80 76" fill="none" :stroke="knob.active?knob.color:'#888'" 
                              :style="{'stroke-dashoffset':184 - 184*((knob.rotation*1 + 132)/264)}"/>
                    </svg>
                </div>
                <div class="rela-block knob-label" :style="{'color':knob.active?'#E4E8EA':'#888'}">{{knob.label}}</div>
            </div>
            
        </div>
    </div>
</div>

</main>
</body>
</html>
